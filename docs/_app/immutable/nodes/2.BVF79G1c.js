import{a as A,t as O,c as We}from"../chunks/B4lGjGS4.js";import{n as la,o as oa,v as ha,w as Ze,O as S,D as xa,at as ba,au as qa,ak as Fa,P as ya,a4 as wa,N as ea,E as ue,_ as Ha,M as Ga,C as Ke,g as s,a1 as Ya,a2 as ca,B as Xe,av as Me,a3 as $a,K as Ea,aw as fa,ax as Ba,J as Va,ay as Wa,S as Ka,y as Xa,ai as Ja,F as Qa,ap as Za,az as aa,aA as ra,a6 as ja,W as va,aB as Aa,aC as er,aD as ar,z as rr,q as tr,aE as ir,aF as nr,a0 as sr,aG as lr,b as or,ao as cr,an as Ua,p as ka,Y as G,k as _,l as v,t as W,j as Pa,aH as fr,as as ye,f as Ce,s as h,i as ae}from"../chunks/DYibF8IW.js";import{d as vr,s as R}from"../chunks/D8Byu7UD.js";import{b as ur,p as dr,a as de,i as we,s as _r,c as ce,d as H}from"../chunks/Dbl-vRMv.js";import{i as gr}from"../chunks/D4BKZ0Lt.js";import{o as Sa,w as Y}from"../chunks/BZSDE__4.js";let ua=!1;function Na(){ua||(ua=!0,document.addEventListener("reset",e=>{Promise.resolve().then(()=>{var a;if(!e.defaultPrevented)for(const r of e.target.elements)(a=r.__on_r)==null||a.call(r)})},{capture:!0}))}function pr(e){var a=ha,r=Ze;la(null),oa(null);try{return e()}finally{la(a),oa(r)}}function La(e,a,r,i=r){e.addEventListener(a,()=>pr(r));const t=e.__on_r;t?e.__on_r=()=>{t(),i(!0)}:e.__on_r=()=>i(!0),Na()}function da(e,a,r){S&&xa();var i=e,t=Ha,n,o=ba()?qa:Fa;ya(()=>{o(t,t=a())&&(n&&wa(n),n=ea(()=>r(i)))}),S&&(i=ue)}function fe(e,a){return a}function mr(e,a,r,i){for(var t=[],n=a.length,o=0;o<n;o++)Ba(a[o].e,t,!0);var b=n>0&&t.length===0&&r!==null;if(b){var $=r.parentNode;Va($),$.append(r),i.clear(),K(e,a[0].prev,a[n-1].next)}Wa(t,()=>{for(var I=0;I<n;I++){var m=a[I];b||(i.delete(m.k),K(e,m.prev,m.next)),Ka(m.e,!b)}})}function ve(e,a,r,i,t,n=null){var o=e,b={flags:a,items:new Map,first:null},$=(a&Aa)!==0;if($){var I=e;o=S?Ke(Xa(I)):I.appendChild(Ga())}S&&xa();var m=null,N=!1,C=Ja(()=>{var l=r();return tr(l)?l:l==null?[]:Ea(l)});ya(()=>{var l=s(C),c=l.length;if(N&&c===0)return;N=c===0;let d=!1;if(S){var q=o.data===Ya;q!==(c===0)&&(o=ca(),Ke(o),Xe(!1),d=!0)}if(S){for(var y=null,w,U=0;U<c;U++){if(ue.nodeType===8&&ue.data===Qa){o=ue,d=!0,Xe(!1);break}var L=l[U],f=i(L,U);w=Ta(ue,b,y,null,L,f,U,t,a),b.items.set(f,w),y=w}c>0&&Ke(ca())}if(!S){var u=ha;hr(l,b,o,t,a,(u.f&Me)!==0,i)}n!==null&&(c===0?m?$a(m):m=ea(()=>n(o)):m!==null&&wa(m,()=>{m=null})),d&&Xe(!0),s(C)}),S&&(o=ue)}function hr(e,a,r,i,t,n,o,b){var ke,Pe,Se,g;var $=(t&er)!==0,I=(t&(aa|ra))!==0,m=e.length,N=a.items,C=a.first,l=C,c,d=null,q,y=[],w=[],U,L,f,u;if($)for(u=0;u<m;u+=1)U=e[u],L=o(U,u),f=N.get(L),f!==void 0&&((ke=f.a)==null||ke.measure(),(q??(q=new Set)).add(f));for(u=0;u<m;u+=1){if(U=e[u],L=o(U,u),f=N.get(L),f===void 0){var Ue=l?l.e.nodes_start:r;d=Ta(Ue,a,d,d===null?a.first:d.next,U,L,u,i,t),N.set(L,d),y=[],w=[],l=d.next;continue}if(I&&xr(f,U,u,t),f.e.f&Me&&($a(f.e),$&&((Pe=f.a)==null||Pe.unfix(),(q??(q=new Set)).delete(f))),f!==l){if(c!==void 0&&c.has(f)){if(y.length<w.length){var J=w[0],M;d=J.prev;var he=y[0],B=y[y.length-1];for(M=0;M<y.length;M+=1)_a(y[M],J,r);for(M=0;M<w.length;M+=1)c.delete(w[M]);K(a,he.prev,B.next),K(a,d,he),K(a,B,J),l=J,d=B,u-=1,y=[],w=[]}else c.delete(f),_a(f,l,r),K(a,f.prev,f.next),K(a,f,d===null?a.first:d.next),K(a,d,f),d=f;continue}for(y=[],w=[];l!==null&&l.k!==L;)(n||!(l.e.f&Me))&&(c??(c=new Set)).add(l),w.push(l),l=l.next;if(l===null)continue;f=l}y.push(f),d=f,l=f.next}if(l!==null||c!==void 0){for(var V=c===void 0?[]:Ea(c);l!==null;)(n||!(l.e.f&Me))&&V.push(l),l=l.next;var Q=V.length;if(Q>0){var De=t&Aa&&m===0?r:null;if($){for(u=0;u<Q;u+=1)(Se=V[u].a)==null||Se.measure();for(u=0;u<Q;u+=1)(g=V[u].a)==null||g.fix()}mr(a,V,De,N)}}$&&Za(()=>{var E;if(q!==void 0)for(f of q)(E=f.a)==null||E.apply()}),Ze.first=a.first&&a.first.e,Ze.last=d&&d.e}function xr(e,a,r,i){i&aa&&fa(e.v,a),i&ra?fa(e.i,r):e.i=r}function Ta(e,a,r,i,t,n,o,b,$,I){var m=($&aa)!==0,N=($&ar)===0,C=m?N?ja(t):va(t):t,l=$&ra?va(o):o,c={i:l,v:C,k:n,a:null,e:null,prev:r,next:i};try{return c.e=ea(()=>b(e,C,l),S),c.e.prev=r&&r.e,c.e.next=i&&i.e,r===null?a.first=c:(r.next=c,r.e.next=c.e),i!==null&&(i.prev=c,i.e.prev=c.e),c}finally{}}function _a(e,a,r){for(var i=e.next?e.next.e.nodes_start:r,t=a?a.e.nodes_start:r,n=e.e.nodes_start;n!==i;){var o=rr(n);t.before(n),n=o}}function K(e,a,r){a===null?e.first=r:(a.next=r,a.e.next=r&&r.e),r!==null&&(r.prev=a,r.e.prev=a&&a.e)}function ga(e){if(S){var a=!1,r=()=>{if(!a){if(a=!0,e.hasAttribute("value")){var i=e.value;X(e,"value",null),e.value=i}if(e.hasAttribute("checked")){var t=e.checked;X(e,"checked",null),e.checked=t}}};e.__on_r=r,ir(r),Na()}}function X(e,a,r,i){var t=e.__attributes??(e.__attributes={});S&&(t[a]=e.getAttribute(a),a==="src"||a==="srcset"||a==="href"&&e.nodeName==="LINK")||t[a]!==(t[a]=r)&&(a==="style"&&"__styles"in e&&(e.__styles={}),a==="loading"&&(e[nr]=r),r==null?e.removeAttribute(a):typeof r!="string"&&br(e).includes(a)?e[a]=r:e.setAttribute(a,r))}var pa=new Map;function br(e){var a=pa.get(e.nodeName);if(a)return a;pa.set(e.nodeName,a=[]);for(var r,i=e,t=Element.prototype;t!==i;){r=lr(i);for(var n in r)r[n].set&&a.push(n);i=sr(i)}return a}function ze(e,a,r){var i=e.__className,t=yr(a);S&&e.className===t?e.__className=t:(i!==t||S&&e.className!==t)&&(a==null?e.removeAttribute("class"):e.className=t,e.__className=t)}function yr(e,a){return(e??"")+""}function ma(e,a,r=a){var i=ba();La(e,"input",t=>{var n=t?e.defaultValue:e.value;if(n=Je(e)?Qe(n):n,r(n),i&&n!==(n=a())){var o=e.selectionStart,b=e.selectionEnd;e.value=n??"",b!==null&&(e.selectionStart=o,e.selectionEnd=Math.min(b,e.value.length))}}),(S&&e.defaultValue!==e.value||or(a)==null&&e.value)&&r(Je(e)?Qe(e.value):e.value),cr(()=>{var t=a();Je(e)&&t===Qe(e.value)||e.type==="date"&&!t&&!e.value||t!==e.value&&(e.value=t??"")})}function Je(e){var a=e.type;return a==="number"||a==="range"}function Qe(e){return e===""?null:+e}function Ia(e,a,r){if(e.multiple)return Er(e,a);for(var i of e.options){var t=Ee(i);if(ur(t,a)){i.selected=!0;return}}(!r||a!==void 0)&&(e.selectedIndex=-1)}function wr(e,a){Ua(()=>{var r=new MutationObserver(()=>{var i=e.__value;Ia(e,i)});return r.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{r.disconnect()}})}function $r(e,a,r=a){var i=!0;La(e,"change",t=>{var n=t?"[selected]":":checked",o;if(e.multiple)o=[].map.call(e.querySelectorAll(n),Ee);else{var b=e.querySelector(n)??e.querySelector("option:not([disabled])");o=b&&Ee(b)}r(o)}),Ua(()=>{var t=a();if(Ia(e,t,i),i&&t===void 0){var n=e.querySelector(":checked");n!==null&&(t=Ee(n),r(t))}e.__value=t,i=!1}),wr(e)}function Er(e,a){for(var r of e.options)r.selected=~a.indexOf(Ee(r))}function Ee(e){return"__value"in e?e.__value:e.value}var Ar=O('<div><img class="flex-1 scale-150 object-cover"></div>');function Ur(e,a){ka(a,!1);let r=dr(a,"character",8),i=fr("");Sa(()=>{switch(r().rarity){case 4:G(i,"from-purple-300 to-fuchsia-400");break;case 5:G(i,"from-yellow-300 to-amber-400");break;case 6:G(i,"from-red-300 to-orange-400")}}),gr();var t=Ar(),n=_(t);v(t),W(()=>{ze(t,`flex h-[640px] items-center justify-center overflow-hidden bg-gradient-to-b ${s(i)??""} flex flex-col items-center shadow-lg`),X(n,"src",r().imgUrl),X(n,"alt",r().name)}),A(e,t),Pa()}const re={angelina:{name:"Gilberta",rarity:6,imgUrl:"https://web-static.hg-cdn.com/endfield/official-v3/oversea/assets/img/illust.419e55.png"},lifeng:{name:"Lifeng",rarity:6,imgUrl:"https://web-static.hg-cdn.com/endfield/official-v3/oversea/assets/img/illust.4f2d92.png"},yvonne:{name:"Yvonne",rarity:6,imgUrl:"https://web-static.hg-cdn.com/endfield/official-v3/oversea/assets/img/illust.de815f.png"},ember:{name:"Ember",rarity:6,imgUrl:"https://web-static.hg-cdn.com/endfield/official-v3/oversea/assets/img/illust.59e1c7.png"},surtr:{name:"Laevatain",rarity:6,imgUrl:"https://web-static.hg-cdn.com/endfield/official-v3/oversea/assets/img/illust.3a3df5.png"},honse:{name:"Arclight",rarity:5,imgUrl:"https://web-static.hg-cdn.com/endfield/official-v3/oversea/assets/img/illust.3d1246.png"},panda:{name:"Da Pan",rarity:5,imgUrl:"https://web-static.hg-cdn.com/endfield/official-v3/oversea/assets/img/illust.48c105.png"},perlica:{name:"Perlica",rarity:5,imgUrl:"https://web-static.hg-cdn.com/endfield/official-v3/oversea/assets/img/illust.1fb4d9.png"},avywenna:{name:"Avywenna",rarity:5,imgUrl:"https://web-static.hg-cdn.com/endfield/official-v3/oversea/assets/img/illust.a3194b.png"},xaihi:{name:"Xaihi",rarity:4,imgUrl:"https://web-static.hg-cdn.com/endfield/official-v3/oversea/assets/img/illust.1e2b00.png"},aurora:{name:"Snowshine",rarity:4,imgUrl:"https://web-static.hg-cdn.com/endfield/official-v3/oversea/assets/img/illust.85fda3.png"},wulfgard:{name:"Wulfgard",rarity:4,imgUrl:"https://web-static.hg-cdn.com/endfield/official-v3/oversea/assets/img/illust.5cbcb0.png"},chen:{name:"Chen Qianyu",rarity:4,imgUrl:"https://web-static.hg-cdn.com/endfield/official-v3/oversea/assets/img/illust.2730c2.png"}};function D(e){let a;return e.subscribe(i=>{a=i})(),a}const ge=Y(0),pe=Y(0),me=Y(0),Re=Y(0),Ae=Y(!0),Oe=Y("surtr"),ta=Y("avywenna"),ia=Y(new Map),je=Y([]);function _e(e,a){a&&je.update(r=>[`[${new Date().toISOString().split("T")[1].slice(0,-1)}] ${e}`,...r])}function $e(e,a,r){if(a>=5&&pe.set(0),a>=6&&(me.set(0),ge.set(0)),Math.random()<=.5)switch(a){case 5:return _e("Won 5★ rate-up",r),D(ta);case 6:return Ae.set(!1),_e("Won 6★ rate-up",r),D(Oe)}const t=e.get(a);if(t)return t[Math.floor(Math.random()*(t.length??[]))]}function kr(){const e=new Map;for(let a=1;a<=6;a++)e.set(a,Object.entries(re).filter(([r,i])=>i.rarity===a&&r!==D(ta)&&r!==D(Oe)).map(([r,i])=>r));ia.set(e)}function Ca(e){const a=D(ia);if(!a)return;if(me.update(n=>n+1),pe.update(n=>n+1),ge.update(n=>n+1),Re.update(n=>n+1),(D(Re)??0)%120===0&&D(Ae))return pe.set(0),me.set(0),ge.set(0),Ae.set(!1),_e("6★ Forced Pity",e),D(Oe);const r=Math.random(),i=D(ge)??0,t=i>=65?(i-65)*.05+.008:.008;return r<t?(_e(`6★ ${i} @ ${(t*100).toFixed(1)}%`,e),$e(a,6,e)):(D(me)??0)%80===0?(_e("6★ Pity",e),$e(a,6,e)):r<t+.08?$e(a,5,e):(D(pe)??0)%10===0?(_e("5★ Pity",e),$e(a,5,e)):$e(a,4,e)}function Pr(e,a,r,i){const t=s(a)<=1e3;console.log(t),G(r,de([]));for(let n=0;n<s(a);n++){const o=Ca(t);o&&(t&&s(r).push(re[o]),o in s(i)?s(i)[o]++:s(i)[o]=1)}}var Sr=(e,a,r,i)=>a(s(r),s(i)),Nr=O("<option> </option>"),Lr=O("<p> </p>"),Tr=O('<div class="grid w-full grid-cols-10 gap-1"></div>'),Ir=O("<p> </p>"),Cr=O('<p class="text-xl">Logs</p> <div class="flex h-64 flex-col gap-2 overflow-y-scroll rounded-lg bg-zinc-800 p-4"></div>',1),Mr=O('<div><div><div class="h-32 w-32 overflow-hidden rounded-lg"><img class="scale-[2]"></div> <p> </p> <p> </p> <p class="text-right"> </p></div></div>'),zr=O('<div class="flex flex-col gap-2"><p> </p> <p> </p> <!> <p> </p></div> <!> <!> <p class="text-xl"> </p> <div class="flex flex-wrap gap-2"></div>',1),Rr=O('<div><div class="h-32 w-32 overflow-hidden rounded-lg"><img class="scale-[3]"></div> <p> </p></div>'),Or=O('<p class="text-lg"> </p> <div class="flex gap-2 rounded-lg bg-zinc-800 p-4"></div>',1),Dr=O('<p class="text-xl">Gacha Pool</p> <!>',1),qr=O('<div class="flex flex-col gap-4 p-8 font-medium"><h1 class="text-2xl">Endfield Gacha Simulator</h1> <div class="flex gap-4"><button class="flex w-fit items-center gap-2 bg-yellow-400 px-2 py-1 text-zinc-900"><div class="h-1 w-1 bg-zinc-900"></div> ROLL <div class="h-1 w-1 bg-zinc-900"></div></button> <input type="number" class="w-32 text-zinc-900"></div> <div class="flex gap-4"><button class="flex w-fit items-center gap-2 bg-yellow-400 px-2 py-1 text-zinc-900"><div class="h-1 w-1 bg-zinc-900"></div> ROLL UNTIL <div class="h-1 w-1 bg-zinc-900"></div></button> <select class="w-fit text-zinc-900"></select> <input type="number" class="w-32 text-zinc-900"></div> <div class="flex gap-4"><button class="flex w-fit items-center gap-2 bg-yellow-400 px-2 py-1 text-zinc-900"><div class="h-1 w-1 bg-zinc-900"></div> RESET <div class="h-1 w-1 bg-zinc-900"></div></button></div> <!></div>');function Wr(e,a){ka(a,!0);const[r,i]=_r(),t=()=>H(me,"$sixPity",r),n=()=>H(pe,"$fivePity",r),o=()=>H(ge,"$softPityRollCount",r),b=()=>H(Re,"$forcePity",r),$=()=>H(Ae,"$forceToggle",r),I=()=>H(je,"$gachaLogs",r),m=()=>H(ta,"$rateUpFive",r),N=()=>H(Oe,"$rateUpSix",r),C=()=>H(ia,"$gachaPool",r);let l=ye(de([])),c=ye(de({}));const d=Ce(()=>Object.values(s(c)).reduce((g,E)=>g+E,0));let q=ye(10),y=ye("perlica"),w=ye(6);function U(g,E){for(L();;){const k=Ca(!1);if(k&&(k in s(c)?s(c)[k]++:s(c)[k]=1),g in s(c)&&s(c)[g]>=E)return}}Sa(()=>{kr()});function L(){ce(me,0),ce(pe,0),ce(ge,0),ce(Re,0),ce(Ae,!0),ce(je,de([])),G(l,de([])),G(c,de({}))}var f=qr(),u=h(_(f),2),Ue=_(u);Ue.__click=[Pr,q,l,c];var J=h(Ue,2);ga(J),v(u);var M=h(u,2),he=_(M);he.__click=[Sr,U,y,w];var B=h(he,2);ve(B,21,()=>Object.entries(re),fe,(g,E)=>{let k=()=>s(E)[0],Z=()=>s(E)[1];var P=Nr(),F={},te=_(P,!0);v(P),W(()=>{F!==(F=k())&&(P.value=(P.__value=k())==null?"":k()),R(te,Z().name)}),A(g,P)}),v(B);var V=h(B,2);ga(V),v(M);var Q=h(M,2),De=_(Q);De.__click=L,v(Q);var ke=h(Q,2);{var Pe=g=>{var E=zr(),k=ae(E),Z=_(k),P=_(Z);v(Z);var F=h(Z,2),te=_(F);v(F);var Ne=h(F,2);{var qe=p=>{var x=Lr(),z=_(x);v(x),W(()=>R(z,`${120-b()} rolls until rate-up`)),A(p,x)};we(Ne,p=>{$()&&p(qe)})}var ie=h(Ne,2),Le=_(ie);v(ie),v(k);var ne=h(k,2);{var Fe=p=>{var x=Tr();ve(x,21,()=>s(l),fe,(z,oe)=>{var ee=We(),T=ae(ee);da(T,()=>s(oe),be=>{Ur(be,{get character(){return s(oe)}})}),A(z,ee)}),v(x),A(p,x)};we(ne,p=>{s(l).length>0&&p(Fe)})}var xe=h(ne,2);{var He=p=>{var x=Cr(),z=h(ae(x),2);ve(z,5,I,fe,(oe,ee)=>{var T=Ir(),be=_(T,!0);v(T),W(()=>R(be,s(ee))),A(oe,T)}),v(z),A(p,x)};we(xe,p=>{I().length>0&&p(He)})}var j=h(xe,2),se=_(j);v(j);var le=h(j,2);ve(le,21,()=>Object.entries(s(c)).sort(([p],[x])=>re[x].rarity-re[p].rarity).reduce((p,x)=>[...p,x],new Array),fe,(p,x)=>{let z=()=>s(x)[0],oe=()=>s(x)[1];var ee=We();const T=Ce(()=>re[z()]);var be=ae(ee);da(be,()=>s(T),Ma=>{var Ie=Mr(),Ge=_(Ie),Ye=_(Ge),na=_(Ye);v(Ye);var Be=h(Ye,2),za=_(Be,!0);v(Be);var Ve=h(Be,2),Ra=_(Ve,!0);v(Ve);var sa=h(Ve,2),Oa=_(sa);v(sa),v(Ge),v(Ie),W(Da=>{ze(Ie,`flex w-fit flex-col gap-2 rounded-md p-[5px] text-zinc-900
					${z()===m()||z()===N()?"bg-zinc-100":""}
					`),ze(Ge,`flex w-fit flex-col gap-1 rounded-md bg-gradient-to-br p-2 ${s(T).rarity===6?"from-red-300 to-orange-400":s(T).rarity===5?"from-yellow-300 to-amber-400":"from-purple-300 to-fuchsia-400"}`),X(na,"src",s(T).imgUrl),X(na,"alt",s(T).name),R(za,Da),R(Ra,s(T).name),R(Oa,`x${oe()??""}`)},[()=>"★".repeat(s(T).rarity)]),A(Ma,Ie)}),A(p,ee)}),v(le),W(p=>{R(P,`${10-n()} rolls until 5★ or better`),R(te,`${80-t()} rolls until 6★`),R(Le,`Current 6★ Rate: ${p??""}%`),R(se,`Pulled characters (${s(d)??""})`)},[()=>(o()>=65?(o()-65)*5+.8:.8).toFixed(1)]),A(g,E)},Se=g=>{var E=Dr(),k=h(ae(E),2);ve(k,1,()=>C().keys(),fe,(Z,P)=>{var F=We();const te=Ce(()=>s(P)==6?[N(),...C().get(s(P))??[]]:s(P)==5?[m(),...C().get(s(P))??[]]:C().get(s(P))??[]);var Ne=ae(F);{var qe=ie=>{var Le=Or(),ne=ae(Le),Fe=_(ne);v(ne);var xe=h(ne,2);ve(xe,21,()=>s(te),fe,(He,j)=>{var se=Rr();const le=Ce(()=>re[s(j)]);var Te=_(se),p=_(Te);v(Te);var x=h(Te,2),z=_(x,!0);v(x),v(se),W(()=>{ze(se,`flex flex-col gap-2 rounded-md p-2 ${s(j)===m()||s(j)===N()?"bg-gradient-to-br from-orange-600 to-amber-400 text-zinc-900":""}`),X(p,"src",s(le).imgUrl),X(p,"alt",s(le).name),R(z,s(le).name)}),A(He,se)}),v(xe),W(()=>R(Fe,`${s(P)??""}★`)),A(ie,Le)};we(Ne,ie=>{s(te).length>0&&ie(qe)})}A(Z,F)}),A(g,E)};we(ke,g=>{s(d)>0?g(Pe):g(Se,!1)})}v(f),ma(J,()=>s(q),g=>G(q,g)),$r(B,()=>s(y),g=>G(y,g)),ma(V,()=>s(w),g=>G(w,g)),A(e,f),Pa(),i()}vr(["click"]);export{Wr as component};
