import{a as I,t as F,c as Ve}from"../chunks/C4IPX_T2.js";import{n as We,o as Ke,v as aa,w as ze,O as A,D as ra,at as ta,au as ma,ak as xa,P as ia,a4 as sa,N as De,E as se,_ as ya,C as Ce,y as ba,M as wa,g as l,a1 as $a,a2 as Xe,B as Se,F as Ea,av as we,a3 as na,K as la,ap as Pa,aw as Oe,ax as Je,ay as Fe,az as Ua,J as Aa,aA as ka,S as Na,aB as oa,ai as Ta,aC as Ca,a5 as Sa,W as Qe,q as Ia,aD as La,z as Ma,aE as Ra,aF as za,a0 as Da,aG as Oa,b as Fa,ao as Ha,p as ca,Y as ee,k as g,l as u,t as j,j as fa,aH as qa,as as Ie,s as y,i as te,f as Le}from"../chunks/reHBiqEw.js";import{d as Ga,s as L}from"../chunks/UFBG4KVt.js";import{p as Ya,a as le,i as be,s as ie,b as Ba,c as G}from"../chunks/CRnr0ZzT.js";import{i as Va}from"../chunks/DPVL_Rzw.js";import{o as va,w as Y}from"../chunks/DocNpvQJ.js";let Ze=!1;function da(){Ze||(Ze=!0,document.addEventListener("reset",e=>{Promise.resolve().then(()=>{var a;if(!e.defaultPrevented)for(const r of e.target.elements)(a=r.__on_r)==null||a.call(r)})},{capture:!0}))}function Wa(e){var a=aa,r=ze;We(null),Ke(null);try{return e()}finally{We(a),Ke(r)}}function Ka(e,a,r,i=r){e.addEventListener(a,()=>Wa(r));const t=e.__on_r;t?e.__on_r=()=>{t(),i(!0)}:e.__on_r=()=>i(!0),da()}function Xa(e,a,r){A&&ra();var i=e,t=ya,s,f=ta()?ma:xa;ia(()=>{f(t,t=a())&&(s&&sa(s),s=De(()=>r(i)))}),A&&(i=se)}function _e(e,a){return a}function Ja(e,a,r,i){for(var t=[],s=a.length,f=0;f<s;f++)Ua(a[f].e,t,!0);var m=s>0&&t.length===0&&r!==null;if(m){var x=r.parentNode;Aa(x),x.append(r),i.clear(),W(e,a[0].prev,a[s-1].next)}ka(t,()=>{for(var k=0;k<s;k++){var _=a[k];m||(i.delete(_.k),W(e,_.prev,_.next)),Na(_.e,!m)}})}function ge(e,a,r,i,t,s=null){var f=e,m={flags:a,items:new Map,first:null},x=(a&oa)!==0;if(x){var k=e;f=A?Ce(ba(k)):k.appendChild(wa())}A&&ra();var _=null,N=!1,C=Ta(()=>{var n=r();return Ia(n)?n:n==null?[]:la(n)});ia(()=>{var n=l(C),c=n.length;if(N&&c===0)return;N=c===0;let d=!1;if(A){var R=f.data===$a;R!==(c===0)&&(f=Xe(),Ce(f),Se(!1),d=!0)}if(A){for(var b=null,$,w=0;w<c;w++){if(se.nodeType===8&&se.data===Ea){f=se,d=!0,Se(!1);break}var S=n[w],o=i(S,w);$=ua(se,m,b,null,S,o,w,t,a),m.items.set(o,$),b=$}c>0&&Ce(Xe())}if(!A){var v=aa;Qa(n,m,f,t,a,(v.f&we)!==0,i)}s!==null&&(c===0?_?na(_):_=De(()=>s(f)):_!==null&&sa(_,()=>{_=null})),d&&Se(!0),l(C)}),A&&(f=se)}function Qa(e,a,r,i,t,s,f,m){var X,re,q,J;var x=(t&Ca)!==0,k=(t&(Oe|Fe))!==0,_=e.length,N=a.items,C=a.first,n=C,c,d=null,R,b=[],$=[],w,S,o,v;if(x)for(v=0;v<_;v+=1)w=e[v],S=f(w,v),o=N.get(S),o!==void 0&&((X=o.a)==null||X.measure(),(R??(R=new Set)).add(o));for(v=0;v<_;v+=1){if(w=e[v],S=f(w,v),o=N.get(S),o===void 0){var Ae=n?n.e.nodes_start:r;d=ua(Ae,a,d,d===null?a.first:d.next,w,S,v,i,t),N.set(S,d),b=[],$=[],n=d.next;continue}if(k&&Za(o,w,v,t),o.e.f&we&&(na(o.e),x&&((re=o.a)==null||re.unfix(),(R??(R=new Set)).delete(o))),o!==n){if(c!==void 0&&c.has(o)){if(b.length<$.length){var T=$[0],E;d=T.prev;var B=b[0],H=b[b.length-1];for(E=0;E<b.length;E+=1)je(b[E],T,r);for(E=0;E<$.length;E+=1)c.delete($[E]);W(a,B.prev,H.next),W(a,d,B),W(a,H,T),n=T,d=H,v-=1,b=[],$=[]}else c.delete(o),je(o,n,r),W(a,o.prev,o.next),W(a,o,d===null?a.first:d.next),W(a,d,o),d=o;continue}for(b=[],$=[];n!==null&&n.k!==S;)(s||!(n.e.f&we))&&(c??(c=new Set)).add(n),$.push(n),n=n.next;if(n===null)continue;o=n}b.push(o),d=o,n=o.next}if(n!==null||c!==void 0){for(var P=c===void 0?[]:la(c);n!==null;)(s||!(n.e.f&we))&&P.push(n),n=n.next;var z=P.length;if(z>0){var ae=t&oa&&_===0?r:null;if(x){for(v=0;v<z;v+=1)(q=P[v].a)==null||q.measure();for(v=0;v<z;v+=1)(J=P[v].a)==null||J.fix()}Ja(a,P,ae,N)}}x&&Pa(()=>{var D;if(R!==void 0)for(o of R)(D=o.a)==null||D.apply()}),ze.first=a.first&&a.first.e,ze.last=d&&d.e}function Za(e,a,r,i){i&Oe&&Je(e.v,a),i&Fe?Je(e.i,r):e.i=r}function ua(e,a,r,i,t,s,f,m,x,k){var _=(x&Oe)!==0,N=(x&La)===0,C=_?N?Sa(t):Qe(t):t,n=x&Fe?Qe(f):f,c={i:n,v:C,k:s,a:null,e:null,prev:r,next:i};try{return c.e=De(()=>m(e,C,n),A),c.e.prev=r&&r.e,c.e.next=i&&i.e,r===null?a.first=c:(r.next=c,r.e.next=c.e),i!==null&&(i.prev=c,i.e.prev=c.e),c}finally{}}function je(e,a,r){for(var i=e.next?e.next.e.nodes_start:r,t=a?a.e.nodes_start:r,s=e.e.nodes_start;s!==i;){var f=Ma(s);t.before(s),s=f}}function W(e,a,r){a===null?e.first=r:(a.next=r,a.e.next=r&&r.e),r!==null&&(r.prev=a,r.e.prev=a&&a.e)}function ja(e){if(A){var a=!1,r=()=>{if(!a){if(a=!0,e.hasAttribute("value")){var i=e.value;K(e,"value",null),e.value=i}if(e.hasAttribute("checked")){var t=e.checked;K(e,"checked",null),e.checked=t}}};e.__on_r=r,Ra(r),da()}}function K(e,a,r,i){var t=e.__attributes??(e.__attributes={});A&&(t[a]=e.getAttribute(a),a==="src"||a==="srcset"||a==="href"&&e.nodeName==="LINK")||t[a]!==(t[a]=r)&&(a==="style"&&"__styles"in e&&(e.__styles={}),a==="loading"&&(e[za]=r),r==null?e.removeAttribute(a):typeof r!="string"&&er(e).includes(a)?e[a]=r:e.setAttribute(a,r))}var ea=new Map;function er(e){var a=ea.get(e.nodeName);if(a)return a;ea.set(e.nodeName,a=[]);for(var r,i=e,t=Element.prototype;t!==i;){r=Oa(i);for(var s in r)r[s].set&&a.push(s);i=Da(i)}return a}function $e(e,a,r){var i=e.__className,t=ar(a);A&&e.className===t?e.__className=t:(i!==t||A&&e.className!==t)&&(a==null?e.removeAttribute("class"):e.className=t,e.__className=t)}function ar(e,a){return(e??"")+""}function rr(e,a,r=a){var i=ta();Ka(e,"input",t=>{var s=t?e.defaultValue:e.value;if(s=Me(e)?Re(s):s,r(s),i&&s!==(s=a())){var f=e.selectionStart,m=e.selectionEnd;e.value=s??"",m!==null&&(e.selectionStart=f,e.selectionEnd=Math.min(m,e.value.length))}}),(A&&e.defaultValue!==e.value||Fa(a)==null&&e.value)&&r(Me(e)?Re(e.value):e.value),Ha(()=>{var t=a();Me(e)&&t===Re(e.value)||e.type==="date"&&!t&&!e.value||t!==e.value&&(e.value=t??"")})}function Me(e){var a=e.type;return a==="number"||a==="range"}function Re(e){return e===""?null:+e}var tr=F('<div><img class="flex-1 scale-150 object-cover"></div>');function ir(e,a){ca(a,!1);let r=Ya(a,"character",8),i=qa("");va(()=>{switch(r().rarity){case 4:ee(i,"from-purple-300 to-fuchsia-400");break;case 5:ee(i,"from-yellow-300 to-amber-400");break;case 6:ee(i,"from-red-300 to-orange-400")}}),Va();var t=tr(),s=g(t);u(t),j(()=>{$e(t,`flex h-[640px] items-center justify-center overflow-hidden bg-gradient-to-b ${l(i)??""} flex flex-col items-center shadow-lg`),K(s,"src",r().imgUrl),K(s,"alt",r().name)}),I(e,t),fa()}const Ee={angelina:{name:"Gilberta",rarity:6,imgUrl:"https://web-static.hg-cdn.com/endfield/official-v3/oversea/assets/img/illust.419e55.png"},lifeng:{name:"Lifeng",rarity:6,imgUrl:"https://web-static.hg-cdn.com/endfield/official-v3/oversea/assets/img/illust.4f2d92.png"},yvonne:{name:"Yvonne",rarity:6,imgUrl:"https://web-static.hg-cdn.com/endfield/official-v3/oversea/assets/img/illust.de815f.png"},ember:{name:"Ember",rarity:6,imgUrl:"https://web-static.hg-cdn.com/endfield/official-v3/oversea/assets/img/illust.59e1c7.png"},surtr:{name:"Laevatain",rarity:6,imgUrl:"https://web-static.hg-cdn.com/endfield/official-v3/oversea/assets/img/illust.3a3df5.png"},honse:{name:"Arclight",rarity:5,imgUrl:"https://web-static.hg-cdn.com/endfield/official-v3/oversea/assets/img/illust.3d1246.png"},panda:{name:"Da Pan",rarity:5,imgUrl:"https://web-static.hg-cdn.com/endfield/official-v3/oversea/assets/img/illust.48c105.png"},perlica:{name:"Perlica",rarity:5,imgUrl:"https://web-static.hg-cdn.com/endfield/official-v3/oversea/assets/img/illust.1fb4d9.png"},avywenna:{name:"Avywenna",rarity:5,imgUrl:"https://web-static.hg-cdn.com/endfield/official-v3/oversea/assets/img/illust.a3194b.png"},xaihi:{name:"Xaihi",rarity:4,imgUrl:"https://web-static.hg-cdn.com/endfield/official-v3/oversea/assets/img/illust.1e2b00.png"},aurora:{name:"Snowshine",rarity:4,imgUrl:"https://web-static.hg-cdn.com/endfield/official-v3/oversea/assets/img/illust.85fda3.png"},wulfgard:{name:"Wulfgard",rarity:4,imgUrl:"https://web-static.hg-cdn.com/endfield/official-v3/oversea/assets/img/illust.5cbcb0.png"},chen:{name:"Chen Qianyu",rarity:4,imgUrl:"https://web-static.hg-cdn.com/endfield/official-v3/oversea/assets/img/illust.2730c2.png"}};function M(e){let a;return e.subscribe(i=>{a=i})(),a}const oe=Y(0),ce=Y(0),fe=Y(0),Pe=Y(0),he=Y(!0),Ue=Y("surtr"),He=Y("avywenna"),qe=Y(new Map),Ge=Y([]);function ne(e){Ge.update(a=>[`[${new Date().toISOString().split("T")[1].slice(0,-1)}] ${e}`,...a])}function pe(e,a){if(a>=5&&ce.set(0),a>=6&&(fe.set(0),oe.set(0)),Math.random()<=.5)switch(a){case 5:return ne("Won 5★ rate-up"),M(He);case 6:return he.set(!1),ne("Won 6★ rate-up"),M(Ue)}const i=e.get(a);if(i)return i[Math.floor(Math.random()*(i.length??[]))]}function sr(){const e=new Map;for(let a=1;a<=6;a++)e.set(a,Object.entries(Ee).filter(([r,i])=>i.rarity===a&&r!==M(He)&&r!==M(Ue)).map(([r,i])=>r));qe.set(e)}function nr(){const e=M(qe);if(!e)return;if(fe.update(t=>t+1),ce.update(t=>t+1),oe.update(t=>t+1),Pe.update(t=>t+1),(M(Pe)??0)%120===0&&M(he))return ce.set(0),fe.set(0),oe.set(0),he.set(!1),ne("6★ Forced Pity"),M(Ue);const a=Math.random(),r=M(oe)??0,i=r>=65?(r-65)*.05+.008:.008;return a<i?(ne(`6★ ${r} @ ${(i*100).toFixed(1)}%`),pe(e,6)):(M(fe)??0)%80===0?(ne("6★ Pity"),pe(e,6)):a<i+.08?pe(e,5):(M(ce)??0)%10===0?(ne("5★ Pity"),pe(e,5)):pe(e,4)}function lr(e,a,r,i){ee(a,le([]));for(let t=0;t<l(r);t++){const s=nr();s&&(l(a).push(Ee[s]),s in l(i)?l(i)[s]++:l(i)[s]=1)}}function or(e,a,r,i,t,s,f,m,x){ie(fe,0),ie(ce,0),ie(oe,0),ie(Pe,0),ie(he,!0),ie(Ge,le([])),ee(m,le([])),ee(x,le({}))}var cr=F("<p> </p>"),fr=F("<p> </p>"),vr=F('<p class="text-xl">Logs</p> <div class="flex h-64 flex-col gap-2 overflow-y-scroll rounded-lg bg-zinc-800 p-4"></div>',1),dr=F('<div><div><div class="h-32 w-32 overflow-hidden rounded-lg"><img class="scale-[2]"></div> <p> </p> <p> </p> <p class="text-right"> </p></div></div>'),ur=F('<div class="flex flex-col gap-2"><p> </p> <p> </p> <!> <p> </p></div> <div class="grid w-full grid-cols-10 gap-1"></div> <!> <p class="text-xl"> </p> <div class="flex flex-wrap gap-2"></div>',1),_r=F('<div><div class="h-32 w-32 overflow-hidden rounded-lg"><img class="scale-[3]"></div> <p> </p></div>'),gr=F('<p class="text-lg"> </p> <div class="flex gap-2 rounded-lg bg-zinc-800 p-4"></div>',1),pr=F('<p class="text-xl">Gacha Pool</p> <!>',1),hr=F('<div class="flex flex-col gap-4 p-8 font-medium"><h1 class="text-2xl">Endfield Gacha Simulator</h1> <div class="flex gap-4"><button class="flex w-fit items-center gap-2 bg-yellow-400 px-2 py-1 text-zinc-900"><div class="h-1 w-1 bg-zinc-900"></div> ROLL <div class="h-1 w-1 bg-zinc-900"></div></button> <input type="number" class="w-32 text-zinc-900"> <button class="flex w-fit items-center gap-2 bg-yellow-400 px-2 py-1 text-zinc-900"><div class="h-1 w-1 bg-zinc-900"></div> RESET <div class="h-1 w-1 bg-zinc-900"></div></button></div> <!></div>');function Er(e,a){ca(a,!0);const[r,i]=Ba(),t=()=>G(fe,"$sixPity",r),s=()=>G(ce,"$fivePity",r),f=()=>G(oe,"$softPityRollCount",r),m=()=>G(Pe,"$forcePity",r),x=()=>G(he,"$forceToggle",r),k=()=>G(Ge,"$gachaLogs",r),_=()=>G(He,"$rateUpFive",r),N=()=>G(Ue,"$rateUpSix",r),C=()=>G(qe,"$gachaPool",r);let n=Ie(le([])),c=Ie(le({})),d=Ie(10);va(()=>{sr()});var R=hr(),b=y(g(R),2),$=g(b);$.__click=[lr,n,d,c];var w=y($,2);ja(w);var S=y(w,2);S.__click=[or,t,s,f,m,x,k,n,c],u(b);var o=y(b,2);{var v=T=>{var E=ur(),B=te(E),H=g(B),P=g(H);u(H);var z=y(H,2),ae=g(z);u(z);var X=y(z,2);{var re=p=>{var h=cr(),U=g(h);u(h),j(()=>L(U,`${120-m()} rolls until rate-up`)),I(p,h)};be(X,p=>{x()&&p(re)})}var q=y(X,2),J=g(q);u(q),u(B);var D=y(B,2);ge(D,21,()=>l(n),_e,(p,h)=>{var U=Ve(),Z=te(U);Xa(Z,()=>l(h),V=>{ir(V,{get character(){return l(h)}})}),I(p,U)}),u(D);var me=y(D,2);{var xe=p=>{var h=vr(),U=y(te(h),2);ge(U,5,k,_e,(Z,V)=>{var O=fr(),ue=g(O,!0);u(O),j(()=>L(ue,l(V))),I(Z,O)}),u(U),I(p,h)};be(me,p=>{k().length>0&&p(xe)})}var ve=y(me,2),de=g(ve);u(ve);var Q=y(ve,2);ge(Q,21,()=>Object.entries(l(c)),_e,(p,h)=>{let U=()=>l(h)[0],Z=()=>l(h)[1];var V=dr();const O=Le(()=>Ee[U()]);var ue=g(V),ke=g(ue),Ye=g(ke);u(ke);var Ne=y(ke,2),_a=g(Ne,!0);u(Ne);var Te=y(Ne,2),ga=g(Te,!0);u(Te);var Be=y(Te,2),pa=g(Be);u(Be),u(ue),u(V),j(ha=>{$e(V,`flex w-fit flex-col gap-2 rounded-md p-[5px] text-zinc-900
					${U()===_()||U()===N()?"bg-zinc-100":""}
					`),$e(ue,`flex w-fit flex-col gap-1 rounded-md bg-gradient-to-br p-2 ${l(O).rarity===6?"from-red-300 to-orange-400":l(O).rarity===5?"from-yellow-300 to-amber-400":"from-purple-300 to-fuchsia-400"}`),K(Ye,"src",l(O).imgUrl),K(Ye,"alt",l(O).name),L(_a,ha),L(ga,l(O).name),L(pa,`x${Z()??""}`)},[()=>"★".repeat(l(O).rarity)]),I(p,V)}),u(Q),j((p,h)=>{L(P,`${10-s()} rolls until 5★ or better`),L(ae,`${80-t()} rolls until 6★`),L(J,`Current 6★ Rate: ${p??""}%`),L(de,`Pulled characters (${h??""})`)},[()=>(f()>=65?(f()-65)*5+.8:.8).toFixed(1),()=>Object.values(l(c)).reduce((p,h)=>p+h,0)]),I(T,E)},Ae=T=>{var E=pr(),B=y(te(E),2);ge(B,1,()=>C().keys(),_e,(H,P)=>{var z=Ve();const ae=Le(()=>l(P)==6?[N(),...C().get(l(P))??[]]:l(P)==5?[_(),...C().get(l(P))??[]]:C().get(l(P))??[]);var X=te(z);{var re=q=>{var J=gr(),D=te(J),me=g(D);u(D);var xe=y(D,2);ge(xe,21,()=>l(ae),_e,(ve,de)=>{var Q=_r();const ye=Le(()=>Ee[l(de)]);var p=g(Q),h=g(p);u(p);var U=y(p,2),Z=g(U,!0);u(U),u(Q),j(()=>{$e(Q,`flex flex-col gap-2 rounded-md p-2 ${l(de)===_()||l(de)===N()?"bg-gradient-to-br from-orange-600 to-amber-400 text-zinc-900":""}`),K(h,"src",l(ye).imgUrl),K(h,"alt",l(ye).name),L(Z,l(ye).name)}),I(ve,Q)}),u(xe),j(()=>L(me,`${l(P)??""}★`)),I(q,J)};be(X,q=>{l(ae).length>0&&q(re)})}I(H,z)}),I(T,E)};be(o,T=>{l(n).length>0?T(v):T(Ae,!1)})}u(R),rr(w,()=>l(d),T=>ee(d,T)),I(e,R),fa(),i()}Ga(["click"]);export{Er as component};
