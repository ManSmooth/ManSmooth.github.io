import{a as P,t as O,c as ia}from"../chunks/B4lGjGS4.js";import{n as na,o as sa,v as ga,w as Xe,O as S,D as pa,at as ma,au as za,ak as Ra,P as ha,a4 as xa,N as Qe,E as ue,_ as Oa,M as Da,C as Be,g as s,a1 as qa,a2 as la,B as Ve,av as Ce,a3 as ba,K as ya,aw as oa,ax as Fa,J as Ha,ay as Ga,S as Ya,y as Ba,ai as Va,F as Wa,ap as Ka,az as Ze,aA as je,a6 as Xa,W as ca,aB as wa,aC as Ja,aD as Qa,z as Za,q as ja,aE as er,aF as ar,a0 as rr,aG as tr,b as ir,ao as nr,an as $a,p as Ea,Y,k as _,l as v,t as K,j as Aa,aH as sr,as as be,f as Ie,s as m,i as oe}from"../chunks/DYibF8IW.js";import{d as lr,s as R}from"../chunks/D8Byu7UD.js";import{b as or,p as cr,a as de,i as ye,s as fr,c as ce,d as G}from"../chunks/Dbl-vRMv.js";import{i as vr}from"../chunks/D4BKZ0Lt.js";import{o as Ua,w as B}from"../chunks/BZSDE__4.js";let fa=!1;function ka(){fa||(fa=!0,document.addEventListener("reset",e=>{Promise.resolve().then(()=>{var a;if(!e.defaultPrevented)for(const r of e.target.elements)(a=r.__on_r)==null||a.call(r)})},{capture:!0}))}function ur(e){var a=ga,r=Xe;na(null),sa(null);try{return e()}finally{na(a),sa(r)}}function Pa(e,a,r,i=r){e.addEventListener(a,()=>ur(r));const t=e.__on_r;t?e.__on_r=()=>{t(),i(!0)}:e.__on_r=()=>i(!0),ka()}function dr(e,a,r){S&&pa();var i=e,t=Oa,n,o=ma()?za:Ra;ha(()=>{o(t,t=a())&&(n&&xa(n),n=Qe(()=>r(i)))}),S&&(i=ue)}function fe(e,a){return a}function _r(e,a,r,i){for(var t=[],n=a.length,o=0;o<n;o++)Fa(a[o].e,t,!0);var h=n>0&&t.length===0&&r!==null;if(h){var $=r.parentNode;Ha($),$.append(r),i.clear(),X(e,a[0].prev,a[n-1].next)}Ga(t,()=>{for(var T=0;T<n;T++){var p=a[T];h||(i.delete(p.k),X(e,p.prev,p.next)),Ya(p.e,!h)}})}function ve(e,a,r,i,t,n=null){var o=e,h={flags:a,items:new Map,first:null},$=(a&wa)!==0;if($){var T=e;o=S?Be(Ba(T)):T.appendChild(Da())}S&&pa();var p=null,N=!1,I=Va(()=>{var l=r();return ja(l)?l:l==null?[]:ya(l)});ha(()=>{var l=s(I),c=l.length;if(N&&c===0)return;N=c===0;let d=!1;if(S){var q=o.data===qa;q!==(c===0)&&(o=la(),Be(o),Ve(!1),d=!0)}if(S){for(var b=null,y,A=0;A<c;A++){if(ue.nodeType===8&&ue.data===Wa){o=ue,d=!0,Ve(!1);break}var L=l[A],f=i(L,A);y=Sa(ue,h,b,null,L,f,A,t,a),h.items.set(f,y),b=y}c>0&&Be(la())}if(!S){var u=ga;gr(l,h,o,t,a,(u.f&Ce)!==0,i)}n!==null&&(c===0?p?ba(p):p=Qe(()=>n(o)):p!==null&&xa(p,()=>{p=null})),d&&Ve(!0),s(I)}),S&&(o=ue)}function gr(e,a,r,i,t,n,o,h){var ke,Pe,Se,g;var $=(t&Ja)!==0,T=(t&(Ze|je))!==0,p=e.length,N=a.items,I=a.first,l=I,c,d=null,q,b=[],y=[],A,L,f,u;if($)for(u=0;u<p;u+=1)A=e[u],L=o(A,u),f=N.get(L),f!==void 0&&((ke=f.a)==null||ke.measure(),(q??(q=new Set)).add(f));for(u=0;u<p;u+=1){if(A=e[u],L=o(A,u),f=N.get(L),f===void 0){var Ue=l?l.e.nodes_start:r;d=Sa(Ue,a,d,d===null?a.first:d.next,A,L,u,i,t),N.set(L,d),b=[],y=[],l=d.next;continue}if(T&&pr(f,A,u,t),f.e.f&Ce&&(ba(f.e),$&&((Pe=f.a)==null||Pe.unfix(),(q??(q=new Set)).delete(f))),f!==l){if(c!==void 0&&c.has(f)){if(b.length<y.length){var Q=y[0],C;d=Q.prev;var he=b[0],V=b[b.length-1];for(C=0;C<b.length;C+=1)va(b[C],Q,r);for(C=0;C<y.length;C+=1)c.delete(y[C]);X(a,he.prev,V.next),X(a,d,he),X(a,V,Q),l=Q,d=V,u-=1,b=[],y=[]}else c.delete(f),va(f,l,r),X(a,f.prev,f.next),X(a,f,d===null?a.first:d.next),X(a,d,f),d=f;continue}for(b=[],y=[];l!==null&&l.k!==L;)(n||!(l.e.f&Ce))&&(c??(c=new Set)).add(l),y.push(l),l=l.next;if(l===null)continue;f=l}b.push(f),d=f,l=f.next}if(l!==null||c!==void 0){for(var W=c===void 0?[]:ya(c);l!==null;)(n||!(l.e.f&Ce))&&W.push(l),l=l.next;var Z=W.length;if(Z>0){var Oe=t&wa&&p===0?r:null;if($){for(u=0;u<Z;u+=1)(Se=W[u].a)==null||Se.measure();for(u=0;u<Z;u+=1)(g=W[u].a)==null||g.fix()}_r(a,W,Oe,N)}}$&&Ka(()=>{var E;if(q!==void 0)for(f of q)(E=f.a)==null||E.apply()}),Xe.first=a.first&&a.first.e,Xe.last=d&&d.e}function pr(e,a,r,i){i&Ze&&oa(e.v,a),i&je?oa(e.i,r):e.i=r}function Sa(e,a,r,i,t,n,o,h,$,T){var p=($&Ze)!==0,N=($&Qa)===0,I=p?N?Xa(t):ca(t):t,l=$&je?ca(o):o,c={i:l,v:I,k:n,a:null,e:null,prev:r,next:i};try{return c.e=Qe(()=>h(e,I,l),S),c.e.prev=r&&r.e,c.e.next=i&&i.e,r===null?a.first=c:(r.next=c,r.e.next=c.e),i!==null&&(i.prev=c,i.e.prev=c.e),c}finally{}}function va(e,a,r){for(var i=e.next?e.next.e.nodes_start:r,t=a?a.e.nodes_start:r,n=e.e.nodes_start;n!==i;){var o=Za(n);t.before(n),n=o}}function X(e,a,r){a===null?e.first=r:(a.next=r,a.e.next=r&&r.e),r!==null&&(r.prev=a,r.e.prev=a&&a.e)}function ua(e){if(S){var a=!1,r=()=>{if(!a){if(a=!0,e.hasAttribute("value")){var i=e.value;J(e,"value",null),e.value=i}if(e.hasAttribute("checked")){var t=e.checked;J(e,"checked",null),e.checked=t}}};e.__on_r=r,er(r),ka()}}function J(e,a,r,i){var t=e.__attributes??(e.__attributes={});S&&(t[a]=e.getAttribute(a),a==="src"||a==="srcset"||a==="href"&&e.nodeName==="LINK")||t[a]!==(t[a]=r)&&(a==="style"&&"__styles"in e&&(e.__styles={}),a==="loading"&&(e[ar]=r),r==null?e.removeAttribute(a):typeof r!="string"&&mr(e).includes(a)?e[a]=r:e.setAttribute(a,r))}var da=new Map;function mr(e){var a=da.get(e.nodeName);if(a)return a;da.set(e.nodeName,a=[]);for(var r,i=e,t=Element.prototype;t!==i;){r=tr(i);for(var n in r)r[n].set&&a.push(n);i=rr(i)}return a}function Me(e,a,r){var i=e.__className,t=hr(a);S&&e.className===t?e.__className=t:(i!==t||S&&e.className!==t)&&(a==null?e.removeAttribute("class"):e.className=t,e.__className=t)}function hr(e,a){return(e??"")+""}function _a(e,a,r=a){var i=ma();Pa(e,"input",t=>{var n=t?e.defaultValue:e.value;if(n=We(e)?Ke(n):n,r(n),i&&n!==(n=a())){var o=e.selectionStart,h=e.selectionEnd;e.value=n??"",h!==null&&(e.selectionStart=o,e.selectionEnd=Math.min(h,e.value.length))}}),(S&&e.defaultValue!==e.value||ir(a)==null&&e.value)&&r(We(e)?Ke(e.value):e.value),nr(()=>{var t=a();We(e)&&t===Ke(e.value)||e.type==="date"&&!t&&!e.value||t!==e.value&&(e.value=t??"")})}function We(e){var a=e.type;return a==="number"||a==="range"}function Ke(e){return e===""?null:+e}function Na(e,a,r){if(e.multiple)return yr(e,a);for(var i of e.options){var t=$e(i);if(or(t,a)){i.selected=!0;return}}(!r||a!==void 0)&&(e.selectedIndex=-1)}function xr(e,a){$a(()=>{var r=new MutationObserver(()=>{var i=e.__value;Na(e,i)});return r.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{r.disconnect()}})}function br(e,a,r=a){var i=!0;Pa(e,"change",t=>{var n=t?"[selected]":":checked",o;if(e.multiple)o=[].map.call(e.querySelectorAll(n),$e);else{var h=e.querySelector(n)??e.querySelector("option:not([disabled])");o=h&&$e(h)}r(o)}),$a(()=>{var t=a();if(Na(e,t,i),i&&t===void 0){var n=e.querySelector(":checked");n!==null&&(t=$e(n),r(t))}e.__value=t,i=!1}),xr(e)}function yr(e,a){for(var r of e.options)r.selected=~a.indexOf($e(r))}function $e(e){return"__value"in e?e.__value:e.value}var wr=O('<div><img class="flex-1 scale-150 object-cover"></div>');function $r(e,a){Ea(a,!1);let r=cr(a,"character",8),i=sr("");Ua(()=>{switch(r().rarity){case 4:Y(i,"from-purple-300 to-fuchsia-400");break;case 5:Y(i,"from-yellow-300 to-amber-400");break;case 6:Y(i,"from-red-300 to-orange-400")}}),vr();var t=wr(),n=_(t);v(t),K(()=>{Me(t,`flex h-[640px] items-center justify-center overflow-hidden bg-gradient-to-b ${s(i)??""} flex flex-col items-center shadow-lg`),J(n,"src",r().imgUrl),J(n,"alt",r().name)}),P(e,t),Aa()}const Ee={angelina:{name:"Gilberta",rarity:6,imgUrl:"https://web-static.hg-cdn.com/endfield/official-v3/oversea/assets/img/illust.419e55.png"},lifeng:{name:"Lifeng",rarity:6,imgUrl:"https://web-static.hg-cdn.com/endfield/official-v3/oversea/assets/img/illust.4f2d92.png"},yvonne:{name:"Yvonne",rarity:6,imgUrl:"https://web-static.hg-cdn.com/endfield/official-v3/oversea/assets/img/illust.de815f.png"},ember:{name:"Ember",rarity:6,imgUrl:"https://web-static.hg-cdn.com/endfield/official-v3/oversea/assets/img/illust.59e1c7.png"},surtr:{name:"Laevatain",rarity:6,imgUrl:"https://web-static.hg-cdn.com/endfield/official-v3/oversea/assets/img/illust.3a3df5.png"},honse:{name:"Arclight",rarity:5,imgUrl:"https://web-static.hg-cdn.com/endfield/official-v3/oversea/assets/img/illust.3d1246.png"},panda:{name:"Da Pan",rarity:5,imgUrl:"https://web-static.hg-cdn.com/endfield/official-v3/oversea/assets/img/illust.48c105.png"},perlica:{name:"Perlica",rarity:5,imgUrl:"https://web-static.hg-cdn.com/endfield/official-v3/oversea/assets/img/illust.1fb4d9.png"},avywenna:{name:"Avywenna",rarity:5,imgUrl:"https://web-static.hg-cdn.com/endfield/official-v3/oversea/assets/img/illust.a3194b.png"},xaihi:{name:"Xaihi",rarity:4,imgUrl:"https://web-static.hg-cdn.com/endfield/official-v3/oversea/assets/img/illust.1e2b00.png"},aurora:{name:"Snowshine",rarity:4,imgUrl:"https://web-static.hg-cdn.com/endfield/official-v3/oversea/assets/img/illust.85fda3.png"},wulfgard:{name:"Wulfgard",rarity:4,imgUrl:"https://web-static.hg-cdn.com/endfield/official-v3/oversea/assets/img/illust.5cbcb0.png"},chen:{name:"Chen Qianyu",rarity:4,imgUrl:"https://web-static.hg-cdn.com/endfield/official-v3/oversea/assets/img/illust.2730c2.png"}};function D(e){let a;return e.subscribe(i=>{a=i})(),a}const ge=B(0),pe=B(0),me=B(0),ze=B(0),Ae=B(!0),Re=B("surtr"),ea=B("avywenna"),aa=B(new Map),Je=B([]);function _e(e,a){a&&Je.update(r=>[`[${new Date().toISOString().split("T")[1].slice(0,-1)}] ${e}`,...r])}function we(e,a,r){if(a>=5&&pe.set(0),a>=6&&(me.set(0),ge.set(0)),Math.random()<=.5)switch(a){case 5:return _e("Won 5★ rate-up",r),D(ea);case 6:return Ae.set(!1),_e("Won 6★ rate-up",r),D(Re)}const t=e.get(a);if(t)return t[Math.floor(Math.random()*(t.length??[]))]}function Er(){const e=new Map;for(let a=1;a<=6;a++)e.set(a,Object.entries(Ee).filter(([r,i])=>i.rarity===a&&r!==D(ea)&&r!==D(Re)).map(([r,i])=>r));aa.set(e)}function La(e){const a=D(aa);if(!a)return;if(me.update(n=>n+1),pe.update(n=>n+1),ge.update(n=>n+1),ze.update(n=>n+1),(D(ze)??0)%120===0&&D(Ae))return pe.set(0),me.set(0),ge.set(0),Ae.set(!1),_e("6★ Forced Pity",e),D(Re);const r=Math.random(),i=D(ge)??0,t=i>=65?(i-65)*.05+.008:.008;return r<t?(_e(`6★ ${i} @ ${(t*100).toFixed(1)}%`,e),we(a,6,e)):(D(me)??0)%80===0?(_e("6★ Pity",e),we(a,6,e)):r<t+.08?we(a,5,e):(D(pe)??0)%10===0?(_e("5★ Pity",e),we(a,5,e)):we(a,4,e)}function Ar(e,a,r,i){const t=s(a)<=1e3;console.log(t),Y(r,de([]));for(let n=0;n<s(a);n++){const o=La(t);o&&(t&&s(r).push(Ee[o]),o in s(i)?s(i)[o]++:s(i)[o]=1)}}var Ur=(e,a,r,i)=>a(s(r),s(i)),kr=O("<option> </option>"),Pr=O("<p> </p>"),Sr=O('<div class="grid w-full grid-cols-10 gap-1"></div>'),Nr=O("<p> </p>"),Lr=O('<p class="text-xl">Logs</p> <div class="flex h-64 flex-col gap-2 overflow-y-scroll rounded-lg bg-zinc-800 p-4"></div>',1),Tr=O('<div><div><div class="h-32 w-32 overflow-hidden rounded-lg"><img class="scale-[2]"></div> <p> </p> <p> </p> <p class="text-right"> </p></div></div>'),Ir=O('<div class="flex flex-col gap-2"><p> </p> <p> </p> <!> <p> </p></div> <!> <!> <p class="text-xl"> </p> <div class="flex flex-wrap gap-2"></div>',1),Cr=O('<div><div class="h-32 w-32 overflow-hidden rounded-lg"><img class="scale-[3]"></div> <p> </p></div>'),Mr=O('<p class="text-lg"> </p> <div class="flex gap-2 rounded-lg bg-zinc-800 p-4"></div>',1),zr=O('<p class="text-xl">Gacha Pool</p> <!>',1),Rr=O('<div class="flex flex-col gap-4 p-8 font-medium"><h1 class="text-2xl">Endfield Gacha Simulator</h1> <div class="flex gap-4"><button class="flex w-fit items-center gap-2 bg-yellow-400 px-2 py-1 text-zinc-900"><div class="h-1 w-1 bg-zinc-900"></div> ROLL <div class="h-1 w-1 bg-zinc-900"></div></button> <input type="number" class="w-32 text-zinc-900"></div> <div class="flex gap-4"><button class="flex w-fit items-center gap-2 bg-yellow-400 px-2 py-1 text-zinc-900"><div class="h-1 w-1 bg-zinc-900"></div> ROLL UNTIL <div class="h-1 w-1 bg-zinc-900"></div></button> <select class="w-fit text-zinc-900"></select> <input type="number" class="w-32 text-zinc-900"></div> <div class="flex gap-4"><button class="flex w-fit items-center gap-2 bg-yellow-400 px-2 py-1 text-zinc-900"><div class="h-1 w-1 bg-zinc-900"></div> RESET <div class="h-1 w-1 bg-zinc-900"></div></button></div> <!></div>');function Yr(e,a){Ea(a,!0);const[r,i]=fr(),t=()=>G(me,"$sixPity",r),n=()=>G(pe,"$fivePity",r),o=()=>G(ge,"$softPityRollCount",r),h=()=>G(ze,"$forcePity",r),$=()=>G(Ae,"$forceToggle",r),T=()=>G(Je,"$gachaLogs",r),p=()=>G(ea,"$rateUpFive",r),N=()=>G(Re,"$rateUpSix",r),I=()=>G(aa,"$gachaPool",r);let l=be(de([])),c=be(de({}));const d=Ie(()=>Object.values(s(c)).reduce((g,E)=>g+E,0));let q=be(10),b=be("perlica"),y=be(6);function A(g,E){for(L();;){const U=La(!1);if(U&&(U in s(c)?s(c)[U]++:s(c)[U]=1),g in s(c)&&s(c)[g]>=E)return}}Ua(()=>{Er()});function L(){ce(me,0),ce(pe,0),ce(ge,0),ce(ze,0),ce(Ae,!0),ce(Je,de([])),Y(l,de([])),Y(c,de({}))}var f=Rr(),u=m(_(f),2),Ue=_(u);Ue.__click=[Ar,q,l,c];var Q=m(Ue,2);ua(Q),v(u);var C=m(u,2),he=_(C);he.__click=[Ur,A,b,y];var V=m(he,2);ve(V,21,()=>Object.entries(Ee),fe,(g,E)=>{let U=()=>s(E)[0],j=()=>s(E)[1];var k=kr(),F={},re=_(k,!0);v(k),K(()=>{F!==(F=U())&&(k.value=(k.__value=U())==null?"":U()),R(re,j().name)}),P(g,k)}),v(V);var W=m(V,2);ua(W),v(C);var Z=m(C,2),Oe=_(Z);Oe.__click=L,v(Z);var ke=m(Z,2);{var Pe=g=>{var E=Ir(),U=oe(E),j=_(U),k=_(j);v(j);var F=m(j,2),re=_(F);v(F);var Ne=m(F,2);{var De=x=>{var w=Pr(),M=_(w);v(w),K(()=>R(M,`${120-h()} rolls until rate-up`)),P(x,w)};ye(Ne,x=>{$()&&x(De)})}var te=m(Ne,2),Le=_(te);v(te),v(U);var ie=m(U,2);{var qe=x=>{var w=Sr();ve(w,21,()=>s(l),fe,(M,le)=>{var H=ia(),z=oe(H);dr(z,()=>s(le),ae=>{$r(ae,{get character(){return s(le)}})}),P(M,H)}),v(w),P(x,w)};ye(ie,x=>{s(l).length>0&&x(qe)})}var xe=m(ie,2);{var Fe=x=>{var w=Lr(),M=m(oe(w),2);ve(M,5,T,fe,(le,H)=>{var z=Nr(),ae=_(z,!0);v(z),K(()=>R(ae,s(H))),P(le,z)}),v(M),P(x,w)};ye(xe,x=>{T().length>0&&x(Fe)})}var ee=m(xe,2),ne=_(ee);v(ee);var se=m(ee,2);ve(se,21,()=>Object.entries(s(c)),fe,(x,w)=>{let M=()=>s(w)[0],le=()=>s(w)[1];var H=Tr();const z=Ie(()=>Ee[M()]);var ae=_(H),He=_(ae),ra=_(He);v(He);var Ge=m(He,2),Ta=_(Ge,!0);v(Ge);var Ye=m(Ge,2),Ia=_(Ye,!0);v(Ye);var ta=m(Ye,2),Ca=_(ta);v(ta),v(ae),v(H),K(Ma=>{Me(H,`flex w-fit flex-col gap-2 rounded-md p-[5px] text-zinc-900
					${M()===p()||M()===N()?"bg-zinc-100":""}
					`),Me(ae,`flex w-fit flex-col gap-1 rounded-md bg-gradient-to-br p-2 ${s(z).rarity===6?"from-red-300 to-orange-400":s(z).rarity===5?"from-yellow-300 to-amber-400":"from-purple-300 to-fuchsia-400"}`),J(ra,"src",s(z).imgUrl),J(ra,"alt",s(z).name),R(Ta,Ma),R(Ia,s(z).name),R(Ca,`x${le()??""}`)},[()=>"★".repeat(s(z).rarity)]),P(x,H)}),v(se),K(x=>{R(k,`${10-n()} rolls until 5★ or better`),R(re,`${80-t()} rolls until 6★`),R(Le,`Current 6★ Rate: ${x??""}%`),R(ne,`Pulled characters (${s(d)??""})`)},[()=>(o()>=65?(o()-65)*5+.8:.8).toFixed(1)]),P(g,E)},Se=g=>{var E=zr(),U=m(oe(E),2);ve(U,1,()=>I().keys(),fe,(j,k)=>{var F=ia();const re=Ie(()=>s(k)==6?[N(),...I().get(s(k))??[]]:s(k)==5?[p(),...I().get(s(k))??[]]:I().get(s(k))??[]);var Ne=oe(F);{var De=te=>{var Le=Mr(),ie=oe(Le),qe=_(ie);v(ie);var xe=m(ie,2);ve(xe,21,()=>s(re),fe,(Fe,ee)=>{var ne=Cr();const se=Ie(()=>Ee[s(ee)]);var Te=_(ne),x=_(Te);v(Te);var w=m(Te,2),M=_(w,!0);v(w),v(ne),K(()=>{Me(ne,`flex flex-col gap-2 rounded-md p-2 ${s(ee)===p()||s(ee)===N()?"bg-gradient-to-br from-orange-600 to-amber-400 text-zinc-900":""}`),J(x,"src",s(se).imgUrl),J(x,"alt",s(se).name),R(M,s(se).name)}),P(Fe,ne)}),v(xe),K(()=>R(qe,`${s(k)??""}★`)),P(te,Le)};ye(Ne,te=>{s(re).length>0&&te(De)})}P(j,F)}),P(g,E)};ye(ke,g=>{s(d)>0?g(Pe):g(Se,!1)})}v(f),_a(Q,()=>s(q),g=>Y(q,g)),br(V,()=>s(b),g=>Y(b,g)),_a(W,()=>s(y),g=>Y(y,g)),P(e,f),Aa(),i()}lr(["click"]);export{Yr as component};
