import{a as I,t as H,c as Te}from"../chunks/BXZ2m0Jm.js";import{O as T,D as De,at as Xe,au as Je,ak as Qe,P as ze,a4 as Oe,N as we,E as ae,_ as Ze,C as ye,y as je,M as ea,g as d,a1 as aa,a2 as Ce,B as be,F as ta,av as pe,a3 as Fe,K as He,ap as ra,w as Ie,aw as $e,ax as Me,ay as Ee,az as ia,J as sa,aA as na,S as la,aB as qe,ai as oa,v as ca,aC as fa,a5 as va,W as Re,q as da,aD as ua,z as ga,aE as pa,a0 as _a,aF as ha,p as Ge,Y as ce,k as E,l as _,t as te,j as Ye,aG as ma,as as xa,s as N,i as j,f as Se}from"../chunks/D8nYJWYn.js";import{d as ya,s as J}from"../chunks/47NwEDMA.js";import{p as ba,a as _e,i as de,s as ee,b as wa,c as F}from"../chunks/Bq8B7IVE.js";import{i as $a}from"../chunks/BovI91R1.js";import{o as Be,w as q}from"../chunks/Cpj5BbhJ.js";function Ea(a,e,t){T&&De();var r=a,i=Ze,n,c=Xe()?Je:Qe;ze(()=>{c(i,i=e())&&(n&&Oe(n),n=we(()=>t(r)))}),T&&(r=ae)}function ue(a,e){return e}function Pa(a,e,t,r){for(var i=[],n=e.length,c=0;c<n;c++)ia(e[c].e,i,!0);var h=n>0&&i.length===0&&t!==null;if(h){var g=t.parentNode;sa(g),g.append(t),r.clear(),Y(a,e[0].prev,e[n-1].next)}na(i,()=>{for(var b=0;b<n;b++){var u=e[b];h||(r.delete(u.k),Y(a,u.prev,u.next)),la(u.e,!h)}})}function ge(a,e,t,r,i,n=null){var c=a,h={flags:e,items:new Map,first:null},g=(e&qe)!==0;if(g){var b=a;c=T?ye(je(b)):b.appendChild(ea())}T&&De();var u=null,P=!1,R=oa(()=>{var s=t();return da(s)?s:s==null?[]:He(s)});ze(()=>{var s=d(R),f=s.length;if(P&&f===0)return;P=f===0;let v=!1;if(T){var S=c.data===aa;S!==(f===0)&&(c=Ce(),ye(c),be(!1),v=!0)}if(T){for(var p=null,m,x=0;x<f;x++){if(ae.nodeType===8&&ae.data===ta){c=ae,v=!0,be(!1);break}var U=s[x],l=r(U,x);m=We(ae,h,p,null,U,l,x,i,e),h.items.set(l,m),p=m}f>0&&ye(Ce())}if(!T){var o=ca;Ua(s,h,c,i,e,(o.f&pe)!==0,r)}n!==null&&(f===0?u?Fe(u):u=we(()=>n(c)):u!==null&&Oe(u,()=>{u=null})),v&&be(!0),d(R)}),T&&(c=ae)}function Ua(a,e,t,r,i,n,c,h){var O,W,z,Q;var g=(i&fa)!==0,b=(i&($e|Ee))!==0,u=a.length,P=e.items,R=e.first,s=R,f,v=null,S,p=[],m=[],x,U,l,o;if(g)for(o=0;o<u;o+=1)x=a[o],U=c(x,o),l=P.get(U),l!==void 0&&((O=l.a)==null||O.measure(),(S??(S=new Set)).add(l));for(o=0;o<u;o+=1){if(x=a[o],U=c(x,o),l=P.get(U),l===void 0){var B=s?s.e.nodes_start:t;v=We(B,e,v,v===null?e.first:v.next,x,U,o,r,i),P.set(U,v),p=[],m=[],s=v.next;continue}if(b&&Aa(l,x,o,i),l.e.f&pe&&(Fe(l.e),g&&((W=l.a)==null||W.unfix(),(S??(S=new Set)).delete(l))),l!==s){if(f!==void 0&&f.has(l)){if(p.length<m.length){var L=m[0],y;v=L.prev;var C=p[0],k=p[p.length-1];for(y=0;y<p.length;y+=1)Le(p[y],L,t);for(y=0;y<m.length;y+=1)f.delete(m[y]);Y(e,C.prev,k.next),Y(e,v,C),Y(e,k,L),s=L,v=k,o-=1,p=[],m=[]}else f.delete(l),Le(l,s,t),Y(e,l.prev,l.next),Y(e,l,v===null?e.first:v.next),Y(e,v,l),v=l;continue}for(p=[],m=[];s!==null&&s.k!==U;)(n||!(s.e.f&pe))&&(f??(f=new Set)).add(s),m.push(s),s=s.next;if(s===null)continue;l=s}p.push(l),v=l,s=l.next}if(s!==null||f!==void 0){for(var D=f===void 0?[]:He(f);s!==null;)(n||!(s.e.f&pe))&&D.push(s),s=s.next;var G=D.length;if(G>0){var le=i&qe&&u===0?t:null;if(g){for(o=0;o<G;o+=1)(z=D[o].a)==null||z.measure();for(o=0;o<G;o+=1)(Q=D[o].a)==null||Q.fix()}Pa(e,D,le,P)}}g&&ra(()=>{var K;if(S!==void 0)for(l of S)(K=l.a)==null||K.apply()}),Ie.first=e.first&&e.first.e,Ie.last=v&&v.e}function Aa(a,e,t,r){r&$e&&Me(a.v,e),r&Ee?Me(a.i,t):a.i=t}function We(a,e,t,r,i,n,c,h,g,b){var u=(g&$e)!==0,P=(g&ua)===0,R=u?P?va(i):Re(i):i,s=g&Ee?Re(c):c,f={i:s,v:R,k:n,a:null,e:null,prev:t,next:r};try{return f.e=we(()=>h(a,R,s),T),f.e.prev=t&&t.e,f.e.next=r&&r.e,t===null?e.first=f:(t.next=f,t.e.next=f.e),r!==null&&(r.prev=f,r.e.prev=f.e),f}finally{}}function Le(a,e,t){for(var r=a.next?a.next.e.nodes_start:t,i=e?e.e.nodes_start:t,n=a.e.nodes_start;n!==r;){var c=ga(n);i.before(n),n=c}}function Y(a,e,t){e===null?a.first=t:(e.next=t,e.e.next=t&&t.e),t!==null&&(t.prev=e,t.e.prev=e&&e.e)}function he(a,e,t,r){var i=a.__attributes??(a.__attributes={});T&&(i[e]=a.getAttribute(e),e==="src"||e==="srcset"||e==="href"&&a.nodeName==="LINK")||i[e]!==(i[e]=t)&&(e==="style"&&"__styles"in a&&(a.__styles={}),e==="loading"&&(a[pa]=t),t==null?a.removeAttribute(e):typeof t!="string"&&Na(a).includes(e)?a[e]=t:a.setAttribute(e,t))}var ke=new Map;function Na(a){var e=ke.get(a.nodeName);if(e)return e;ke.set(a.nodeName,e=[]);for(var t,r=a,i=Element.prototype;i!==r;){t=ha(r);for(var n in t)t[n].set&&e.push(n);r=_a(r)}return e}function Ke(a,e,t){var r=a.__className,i=Ta(e);T&&a.className===i?a.__className=i:(r!==i||T&&a.className!==i)&&(e==null?a.removeAttribute("class"):a.className=i,a.__className=i)}function Ta(a,e){return(a??"")+""}var Ca=H('<div><img class="flex-1 scale-150 object-cover"></div>');function Ia(a,e){Ge(e,!1);let t=ba(e,"character",8),r=ma("");Be(()=>{switch(t().rarity){case 4:ce(r,"from-purple-300 to-fuchsia-400");break;case 5:ce(r,"from-yellow-300 to-amber-400");break;case 6:ce(r,"from-red-300 to-orange-400")}}),$a();var i=Ca(),n=E(i);_(i),te(()=>{Ke(i,`flex h-[640px] items-center justify-center overflow-hidden bg-gradient-to-b ${d(r)??""} flex flex-col items-center shadow-lg`),he(n,"src",t().imgUrl),he(n,"alt",t().name)}),I(a,i),Ye()}const Pe={angelina:{name:"Gilberta",rarity:6,imgUrl:"https://web-static.hg-cdn.com/endfield/official-v3/oversea/assets/img/illust.419e55.png"},lifeng:{name:"Lifeng",rarity:6,imgUrl:"https://web-static.hg-cdn.com/endfield/official-v3/oversea/assets/img/illust.4f2d92.png"},yvonne:{name:"Yvonne",rarity:6,imgUrl:"https://web-static.hg-cdn.com/endfield/official-v3/oversea/assets/img/illust.de815f.png"},ember:{name:"Ember",rarity:6,imgUrl:"https://web-static.hg-cdn.com/endfield/official-v3/oversea/assets/img/illust.59e1c7.png"},surtr:{name:"Laevatain",rarity:6,imgUrl:"https://web-static.hg-cdn.com/endfield/official-v3/oversea/assets/img/illust.3a3df5.png"},honse:{name:"Arclight",rarity:5,imgUrl:"https://web-static.hg-cdn.com/endfield/official-v3/oversea/assets/img/illust.3d1246.png"},panda:{name:"Da Pan",rarity:5,imgUrl:"https://web-static.hg-cdn.com/endfield/official-v3/oversea/assets/img/illust.48c105.png"},perlica:{name:"Perlica",rarity:5,imgUrl:"https://web-static.hg-cdn.com/endfield/official-v3/oversea/assets/img/illust.1fb4d9.png"},avywenna:{name:"Avywenna",rarity:5,imgUrl:"https://web-static.hg-cdn.com/endfield/official-v3/oversea/assets/img/illust.a3194b.png"},xaihi:{name:"Xaihi",rarity:4,imgUrl:"https://web-static.hg-cdn.com/endfield/official-v3/oversea/assets/img/illust.1e2b00.png"},aurora:{name:"Snowshine",rarity:4,imgUrl:"https://web-static.hg-cdn.com/endfield/official-v3/oversea/assets/img/illust.85fda3.png"},wulfgard:{name:"Wulfgard",rarity:4,imgUrl:"https://web-static.hg-cdn.com/endfield/official-v3/oversea/assets/img/illust.5cbcb0.png"},chen:{name:"Chen Qianyu",rarity:4,imgUrl:"https://web-static.hg-cdn.com/endfield/official-v3/oversea/assets/img/illust.2730c2.png"}};function M(a){let e;return a.subscribe(r=>{e=r})(),e}const ie=q(0),se=q(0),ne=q(0),me=q(0),fe=q(!0),xe=q("surtr"),Ue=q("avywenna"),Ae=q(new Map),Ne=q([]);function re(a){Ne.update(e=>[`[${new Date().toISOString().split("T")[1].slice(0,-1)}] ${a}`,...e])}function oe(a,e){if(e>=5&&se.set(0),e>=6&&(ne.set(0),ie.set(0)),Math.random()<=.5)switch(e){case 5:return re("Won 5★ rate-up"),M(Ue);case 6:return fe.set(!1),re("Won 6★ rate-up"),M(xe)}const r=a.get(e);if(r)return r[Math.floor(Math.random()*(r.length??[]))]}function Ma(){const a=new Map;for(let e=1;e<=6;e++)a.set(e,Object.entries(Pe).filter(([t,r])=>r.rarity===e&&t!==M(Ue)&&t!==M(xe)).map(([t,r])=>t));Ae.set(a)}function Ra(){const a=M(Ae);if(!a)return;if(ne.update(i=>i+1),se.update(i=>i+1),ie.update(i=>i+1),me.update(i=>i+1),(M(me)??0)%120===0&&M(fe))return se.set(0),ne.set(0),ie.set(0),fe.set(!1),re("6★ Forced Pity"),M(xe);const e=Math.random(),t=M(ie)??0,r=t>=65?(t-65)*.05+.008:.008;return e<r?(re(`6★ ${t} @ ${(r*100).toFixed(1)}%`),oe(a,6)):(M(ne)??0)%80===0?(re("6★ Pity"),oe(a,6)):e<r+.08?oe(a,5):(M(se)??0)%10===0?(re("5★ Pity"),oe(a,5)):oe(a,4)}function Sa(a,e,t){ce(e,_e([]));for(let r=0;r<t;r++){const i=Ra();i&&d(e).push(Pe[i])}}function La(a,e,t,r,i,n,c,h){ee(ne,0),ee(se,0),ee(ie,0),ee(me,0),ee(fe,!0),ee(Ne,_e([])),ce(h,_e([]))}var ka=H("<p> </p>"),Da=H("<p> </p>"),za=H('<p class="text-xl">Logs</p> <div class="flex h-64 flex-col gap-2 overflow-y-scroll rounded-lg bg-zinc-800 p-4"></div>',1),Oa=H('<div class="flex flex-col gap-2"><p> </p> <p> </p> <!> <p> </p></div> <div class="grid w-full grid-cols-10 gap-1"></div> <!>',1),Fa=H('<div><div class="h-32 w-32 overflow-hidden rounded-lg"><img class="scale-[3]"></div> <p> </p></div>'),Ha=H('<p class="text-lg"> </p> <div class="flex gap-2 rounded-lg bg-zinc-800 p-4"></div>',1),qa=H('<p class="text-xl">Gacha Pool</p> <!>',1),Ga=H('<div class="flex flex-col gap-4 p-8 font-medium"><h1 class="text-2xl">Endfield Gacha Simulator</h1> <div class="flex gap-4"><button class="flex w-fit items-center gap-2 bg-yellow-400 px-2 py-1 text-zinc-900"><div class="h-1 w-1 bg-zinc-900"></div> ROLL <div class="h-1 w-1 bg-zinc-900"></div></button> <button class="flex w-fit items-center gap-2 bg-yellow-400 px-2 py-1 text-zinc-900"><div class="h-1 w-1 bg-zinc-900"></div> RESET <div class="h-1 w-1 bg-zinc-900"></div></button></div> <!></div>');function Ja(a,e){Ge(e,!0);const[t,r]=wa(),i=()=>F(ne,"$sixPity",t),n=()=>F(se,"$fivePity",t),c=()=>F(ie,"$softPityRollCount",t),h=()=>F(me,"$forcePity",t),g=()=>F(fe,"$forceToggle",t),b=()=>F(Ne,"$gachaLogs",t),u=()=>F(Ae,"$gachaPool",t),P=()=>F(xe,"$rateUpSix",t),R=()=>F(Ue,"$rateUpFive",t);let s=xa(_e([]));const f=10;Be(()=>{Ma()});var v=Ga(),S=N(E(v),2),p=E(S);p.__click=[Sa,s,f];var m=N(p,2);m.__click=[La,i,n,c,h,g,b,s],_(S);var x=N(S,2);{var U=o=>{var B=Oa(),L=j(B),y=E(L),C=E(y);_(y);var k=N(y,2),D=E(k);_(k);var G=N(k,2);{var le=w=>{var $=ka(),A=E($);_($),te(()=>J(A,`${120-h()} rolls until rate-up`)),I(w,$)};de(G,w=>{g()&&w(le)})}var O=N(G,2),W=E(O);_(O),_(L);var z=N(L,2);ge(z,21,()=>d(s),ue,(w,$)=>{var A=Te(),V=j(A);Ea(V,()=>d($),X=>{Ia(X,{get character(){return d($)}})}),I(w,A)}),_(z);var Q=N(z,2);{var K=w=>{var $=za(),A=N(j($),2);ge(A,5,b,ue,(V,X)=>{var Z=Da(),ve=E(Z,!0);_(Z),te(()=>J(ve,d(X))),I(V,Z)}),_(A),I(w,$)};de(Q,w=>{b().length>0&&w(K)})}te(w=>{J(C,`${10-n()} rolls until 5★ or better`),J(D,`${80-i()} rolls until 6★`),J(W,`Current 6★ Rate: ${w??""}%`)},[()=>(c()>=65?(c()-65)*5+.8:.8).toFixed(1)]),I(o,B)},l=o=>{var B=qa(),L=N(j(B),2);ge(L,1,()=>u().keys(),ue,(y,C)=>{var k=Te();const D=Se(()=>d(C)==6?[P(),...u().get(d(C))??[]]:d(C)==5?[R(),...u().get(d(C))??[]]:u().get(d(C))??[]);var G=j(k);{var le=O=>{var W=Ha(),z=j(W),Q=E(z);_(z);var K=N(z,2);ge(K,21,()=>d(D),ue,(w,$)=>{var A=Fa();const V=Se(()=>Pe[d($)]);var X=E(A),Z=E(X);_(X);var ve=N(X,2),Ve=E(ve,!0);_(ve),_(A),te(()=>{Ke(A,`flex flex-col gap-2 rounded-md p-2 ${d($)===R()||d($)===P()?"bg-gradient-to-br from-orange-600 to-amber-400 text-zinc-900":""}`),he(Z,"src",d(V).imgUrl),he(Z,"alt",d(V).name),J(Ve,d(V).name)}),I(w,A)}),_(K),te(()=>J(Q,`${d(C)??""}★`)),I(O,W)};de(G,O=>{d(D).length>0&&O(le)})}I(y,k)}),I(o,B)};de(x,o=>{d(s).length>0?o(U):o(l,!1)})}_(v),I(a,v),Ye(),r()}ya(["click"]);export{Ja as component};
